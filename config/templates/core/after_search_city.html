{% extends 'main/base.html' %}


{% block content %}
{% load static %}
{% load humanize %}
{% load mathfilters %}
{% load base_tags %}

<!-- <section class="section-pagetop bg">
    <div class="container">
        <h2 class="title-page">Our Store</h2>
    </div> 
</section>
 -->





{% if coms %}

<section class="section-content padding-y">
    <div class="container">
    
        <div class="row">


            <aside class="col-md-3">
                
                <div class="card">
                    <article class="filter-group">
                        <header class="card-header">
                            <a href="#" data-toggle="collapse" data-target="#collapse_1" aria-expanded="true" class="">
                                <h6 class="title">دسته ها</h6>
                                
                            </a>
                        </header>
                        <div class="filter-content collapse show" id="collapse_1" style="">
                            <div class="card-body">
                                
                                <ul class="list-menu">
                                    {% for cat in all_cats %}
                                        <li><a id="ParentCats" class="eachCat-{{cat.id}}" href="{% url 'eachCategory' cat.id %}" class="eachCat">{{cat.title}}  </a></li>
                                    {% endfor %}
                                </ul>
                
                            </div> <!-- card-body.// -->
                        </div>
                    </article> 
                    <article class="filter-group">
                        <header class="card-header">
                            <!-- <a href="#" data-toggle="collapse" data-target="#collapse_4" aria-expanded="true" class=""> -->
                    
                                <br>
                                
                                <button type="button" class="btn btn-outline-dark" data-toggle="modal" data-target="#exampleModal">
                                    محل
                                </button>
                                    
                                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    
                                        <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel"> تعیین محل</h5>
                                            
                                            </div>
                                            <div class="modal-body">
                                                <p>حداقل یک محله انتخاب کنید.</p>
                                                <br>
                                                <div class="aa">
                                                    <form action="" method="get" id="chooseLocation">
                                                        {% for c in cits %}
                                                            {% for loc in c.location_set.all %}
                                                                <a href="#" style="color:black;text-decoration:none">{{loc.name}}</a>
                                                                <input  type="checkbox" name="ids" id="" value="{{loc.id}}">
                                                                <br>
                                                            {% endfor %}
                                                        {% endfor %}
                                                        <br>
                                                        <br>
                                                        <br>
                                                        <button type="submit" class="btn btn-primary">Save changes</button>
                                                    </form>
                                                    <br>
                                                    <br>
                                                
                                                </div>
                                            </div>
                                            
                                        </div>
                                        </div>
                                    </div>
                                    <br>
                                    <br>
                                    <div class="form-row">

                                        <div class="form-group col-md-6">
                                        <label>حداقل</label>
                                        <!-- <input class="form-control" placeholder="$0" type="number"> -->
                                            <select class="mr-2 form-control" id="choose_min_price" name="least_price">
                                                <option selected="selected" value="5"></option>

                                                
                                                    <option value="5" >5 میلیون</option>

                                                
                                                    <option value="10" >10 میلیون</option>

                                                
                                                    <option value="20" >20 میلیون</option>

                                                
                                                    <option value="50" >50 میلیون</option>

                                                
                                                    <option value="100" >100 میلیون</option>

                                               
                                                    <option value="200" >200 میلیون</option>

                                                
                                            </select>
                                        </div>
                                        <div class="form-group text-right col-md-6">
                                        <label>حداکثر </label>
                                            <select class="mr-2 form-control" id="choose_max_price" name="max_price">
                                                <option selected="selected" value="200"></option>
                                                
                                                    <option value="5" >5 میلیون</option>

                                                
                                                    <option value="10" >10 میلیون</option>

                                            
                                                    <option value="20" >20 میلیون</option>

                                                    <option value="50">50 میلیون</option>

                                                
                                                    <option value="100" >100 میلیون</option>

                                                
                                                    <option value="200" >200 میلیون</option>

                                                
                                            </select>
                                        </div>
                                    </div> 

                                    <br>
                                    <br>
                                    <br>
                                    
                                        <a href="#" style="color:black;text-decoration:none">فقط عکس دار</a>
                                            <input  type="checkbox"  id="justImg" {% if justImg %} checked="checked"{% endif %}>
                                        <br>
                                        <a href="#" style="color:black;text-decoration:none">فقط فوری ها</a>
                                            <input  type="checkbox"  id="justIm" {% if instatnceComs == "فوری" %} checked="checked" {% endif %} >

                                        <br>
                                        
                                    
                                
                                        <script type="text/javascript" >

                                            $("#justImg").change(function(){

                                                    let r7=$("#chooseLocation")
                                                    let min_price_value=$("#choose_min_price").val()
                                                    let max_price_value=$("#choose_max_price").val()
                                                    let ch= r7.children("input").filter("input[type=checkbox]:checked")
                                                    let ids=[]
                                                    ch.each(function(index,el){
                                                        ids.push($(el).attr("value"))
                                                    })
                                                
                                                var instanceStatus=$("input[type=checkbox][id=justIm]")

                                              
                                                
                                                if ( $(this).is(":checked")){

                                                    if(instanceStatus.is(":checked")){
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=فوری`

                                                    }else{
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=عادی`

                                                    }
                                                    
                                                    


                                                }else{
                                                    
                                                    if(instanceStatus.is(":checked")){
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=فوری`

                                                    }else{
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=عادی`

                                                    }
                                                    
                                                }
                                                

                                                

                                            })



                                            $("#justIm").change(function(){


                                                let r7=$("#chooseLocation")
                                                let min_price_value=$("#choose_min_price").val()
                                                let max_price_value=$("#choose_max_price").val()
                                                let ch= r7.children("input").filter("input[type=checkbox]:checked")
                                                let ids=[]
                                                ch.each(function(index,el){
                                                    ids.push($(el).attr("value"))
                                                })

                                            var imgStatus=$("input[type=checkbox][id=justImg]")

                                          
                                            
                                            if ( $(this).is(":checked")){

                                                

                                                if(imgStatus.is(":checked")){
                                                    window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=فوری`

                                                    
                                                }else{
                                                    window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=فوری`

                                                }
                                                
                                                
                                                




                                            }else{
                                                
                                                if(imgStatus.is(":checked")){
                                                    window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=عادی`

                                                    
                                                }else{
                                                    window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=عادی`

                                                }

                                            }
                                            

                                            

                                        })


                                            


                                            $("#chooseLocation").submit(function(e){

                                                e.preventDefault();
                                                const form=new FormData(this)
                                                let min_price_value=$("#choose_min_price").val()
                                                let max_price_value=$("#choose_max_price").val()

                                                let locationIds=[]

                                                for(let i of form){
                                            
                                                    locationIds.push(i[1])
                                                }
                                                let locsIdsToInt=locationIds.map(item=>Number(item))

                                                var imgStatus=$("input[type=checkbox][id=justImg]")
                                                var instanceStatus=$("input[type=checkbox][id=justIm]")

                                                if(imgStatus.is(":checked")){
                                                    if(instanceStatus.is(":checked")){

                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${locationIds.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=فوری`                                                        

                                                    }else{
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${locationIds.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=عادی`                                                        

                                                    }
                                                }else{
                                                    if(instanceStatus.is(":checked")){

                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${locationIds.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=فوری`                                                        

                                                    }else{
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${locationIds.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=عادی`                                                        

                                                    }
                                                }





                                                
                                                
                                                
                                            });


                                            


                                            
                                          


                                            $("#choose_min_price,#choose_max_price").change(function(){
                                                
                                                let r7=$("#chooseLocation")
                                                let min_price_value=$("#choose_min_price").val()
                                                let max_price_value=$("#choose_max_price").val()
                                                let ch= r7.children("input").filter("input[type=checkbox]:checked")
                                                let ids=[]
                                                ch.each(function(index,el){
                                                    ids.push($(el).attr("value"))
                                                })
                                                
                                                var imgStatus=$("input[type=checkbox][id=justImg]")
                                                var instanceStatus=$("input[type=checkbox][id=justIm]")

                                                if(imgStatus.is(":checked")){
                                                    if(instanceStatus.is(":checked")){

                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=فوری`                                                        

                                                    }else{
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=True&instatnceComs=عادی`                                                        

                                                    }
                                                }else{
                                                    if(instanceStatus.is(":checked")){

                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=فوری`                                                        

                                                    }else{
                                                        window.location.href=`http://127.0.0.1:8000/allComsFilter/?ids=${ids.join(',')}&least_price=${min_price_value}&max_price=${max_price_value}&justImg=&instatnceComs=عادی`                                                        

                                                    }
                                                }
                                            
                                            });


 

                                        </script>
                                
                            
                        </header>
                    </article> 
                    
                
                    
                </div> 
        
            </aside> 


            <main class="col-md-9">
        
                <!-- <header class="border-bottom mb-4 pb-3">
                        <div class="form-inline">
                            <span class="mr-md-auto">32 Items found </span>
                            
                        </div>
                </header> -->
        
                <div class="row">
                    {% for c in coms %}

                        <div class="col-md-4">
                            {% if c.com_status == "فوری" %}
                                <span class="badge badge-danger" >فوری </span>
                            {% endif %}
                            <figure class="card card-product-grid" >
                                <div class="img-wrap"> 
                                    {% if c.commericalimage_set.all %}
                                            <img src="{{c.commericalimage_set.first.image.url}}">
                                    {% endif %}
                                    
                                </div> <!-- img-wrap.// -->
                                <figcaption class="info-wrap" >
                                    <div class="fix-height" style="height:100px">
                                        <a href="{% url 'CommericalDetail' c.id %}" class="title">
                                            
                                            {{c.title|slice:"20"}}
                                        </a>
                                        <div class="price-wrap mt-2">


                                            {% if c.parent.parent.parent %}
                                                        <div class="parent parent parent">
                                                                {% if c.parent.parent.parent.title == "املاک" %}
                                                                        <div class="amlak">
                                                                                {% if  c.parent.parent.title == "فروش مسکونی" or c.parent.parent.title == "فروش اداری و تجاری" %}
                                                                                        <span class="price">{{c.price|intcomma}}</span>    تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>    
                                                                                {% elif  c.parent.parent.title == "اجاره مسکونی" or c.parent.parent.title == "اجاره اداری و تجاری" %}
                                                                                        ودیعه <span class="price">{{c.vadieh|intcomma}}</span>    تومان
                                                                                                <br>
                                                                                                اجاره <span class="price">{{c.rent|intcomma}}</span>    تومان <p>
                                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span><span> </span><span>{{c.location.name}}</span>
                                                                                                </p>
                                                                                                <br>
                                                                                                
                                                                                                
                                                                                                <br>
                                                                                                <br>
                                                                                                <br>
                                                                                {% elif c.parent.parent.title == "اجاره کوتاه مدت" %}
                                                                                        <span class="price">{{c.rooms}}</span>    اتاق
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>
                                                                                {% elif c.parent.parent.title == "پروژه‌های ساخت و ساز" %}
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span><span> </span><span>{{c.location.name}}</span>
                                                                                {% endif %}
                                                                        </div>

                                                                        <!-- وسایل نقلیه -->

                                                                {% elif c.parent.parent.parent.title == "وسایل نقلیه" %}
                                                                        <div class="vasayel naghlieh">

                                                                                {% if c.parent.parent %}

                                                                                <!-- خودرو -->
                                                                                        <div class="khodro">
                                                                                                {% if c.parent.parent.title == "خودرو" %}

                                                                                                        {% if c.parent.title == "سواری و وانت" %}
                                                                                                                <span class="price">{{c.karkard_mashin|intcomma}}</span> کیلومتر
                                                                                                                <br>
                                                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span><span> </span><span>{{c.location.name}}</span>
                                                                                                                <br>
                                                                                                        {% elif c.parent.title == "کلاسیک" %}
                                                                                                                <br>
                                                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                                                <br>
                                                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span><span> </span><span>{{c.location.name}}</span>
                                                                                                                <br>
                                                                                                        {% elif c.parent.title == "اجاره‌ای" %}
                                                                                                                <span class="price">{{c.day_rent_paid|intcomma}}</span> تومان
                                                                                                                <br>
                                                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span>   <span> </span><span>{{c.location.name}}</span>
                                                                                                                <br>
                                                                                                        {% elif c.parent.title == "سنگین" %}
                                                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                                                <br>
                                                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                                                <br>    
                                                                                                        {% endif %}

                                                                                                {% endif %}
                                                                                        </div>
                                                                                
                                                                                {% endif %}
                                                                        </div>
                                                                
                                                                {% elif c.parent.parent.parent.title == "کالای دیجیتال" %}
                                                                        <div class="kalay digital">

                                                                                {% if c.parent.parent %}
                                                                                        
                                                                                        {% if c.parent.parent.title == "موبایل و تبلت" %}
                                                                                                <div class="mobile tablet">
                                                                                                        {% if c.parent.title == "گوشی موبایل" or c.parent.title == "تبلت" %}
                                                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                                                <br>
                                                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                                                <br>
                                                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                                                <br>
                       
                                                                                                        {% elif c.parent.title == "لوازم جانبی موبایل و تبلت" or c.parent.title == "سیم کارت" %}

                                                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                                                <br>
                                                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                                                <br>
                                                                                                       

                                                                                                        
                                                                                                        {% endif %}
                                                                                                </div>

                                                                                        {% elif c.parent.parent.title == "رایانه" or c.parent.parent.title == "صوتی و تصویری" %}
                                                                                                <div class="rayaneh va soti va tasviri">
                                                                                                        <span class="price">{{c.phone_status}}</span> 
                                                                                                        <br>
                                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                                        <br>
                                                                                                        <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                                        <br>                                                                    
                                                                                                </div>
                                                                                        

                                                                                        {% endif %}
                                                                                {% endif %}
                                                                        </div>
                                                                {% elif c.parent.parent.parent.title == "خانه و آشپزخانه" %}
                                                                        <div class="ashpazkhanek">
                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                <br>                                                                    
                                                                        </div>
                                                                {% elif c.parent.parent.parent.title == "وسایل شخصی" %}
                                                                        <div class="personal">
                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                <br>                                                                    
                                                                        </div>
                                                                {% elif c.parent.parent.parent.title == "سرگرمی و فراغت" %}
                                                                        <div class="entertament">
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                <br> 
                                                                        </div>
                                                                {% elif c.parent.parent.parent.title == "اجتماعی" %}
                                                                        <div class="social">
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                <br>
                                                                        </div>
                                                                {% elif c.parent.parent.parent.title == "تجهیزات و صنعتی" %}
                                                                        <div class="supplies">
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> <span> </span><span>{{c.location.name}}</span>
                                                                                <br>
                                                                        </div>
                                                                {% endif %}
                                                        </div>


                                            {% elif not c.parent.parent.parent %}
                                                <div class="not parent parent parent"> 
                                                    {% if c.parent.parent %}
                                                                {% if c.parent.parent.title == "وسایل نقلیه" %}
                                                                        <div class="naghlieh">
                                                                                {% if c.parent.title == "موتور سیکلت" %}

                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                
                                                                                {% elif c.parent.title == "قطعات یدکی و لوازم جانبی" %}

                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>

                                                                                {% elif c.parent.title == "قایق و سایر وسایل نقلیه" %}
                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>
                                                                                {% endif %}
                                                                        </div>
                                                                {% elif c.parent.parent.title == "کالای دیجیتال" %}
                                                                        <div class="digital_with_tow_level">
                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                <br> 
                                                                        </div>
                                                                {% elif c.parent.parent.title == "خانه و آشپزخانه" %}
                                                                        <div class="ashpazkhaneh_with_no_three_level">
                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                <br> 
                                                                        </div>
                                                                {% elif c.parent.parent.title == "خدمات" %}
                                                                        <div class="khadamat">
                                                                               <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                <br>
                                                                        </div>
                                                                {% elif c.parent.parent.title == "وسایل شخصی" %}
                                                                        <div class="personal">
                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                <br>                                                                    
                                                                        </div>  
                                                                {% elif c.parent.parent.title == "سرگرمی و فراغت" %}                                   
                                                                        <div class="entertaiment_with_no_third_level">
                                                                                <span class="price">{{c.phone_status}}</span> 
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                <br>  
                                                                        </div>
                                                                {% elif c.parent.parent.title == "تجهیزات و صنعتی" %}
                                                                        <div class="supplies_with_no_third_level">
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                <br>  
                                                                        </div>
                                                                {% elif c.parent.parent.title == "استخدام و کاریابی" %}
                                                                        <div class="employment">
                                                                                <br>
                                                                                <span class="price">{{c.price_for_work|intcomma}}</span> تومان
                                                                                <br>
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                < br>  
                                                                        </div>
                                                                {% endif %}
                                                    {% endif %}
                                                </div>
                                                                            
                                            {% endif %}
                                            
                                        </div> 
                                    </div>
                                    <br>
                                    <br>
                                    <br>
          
                                </figcaption>
                            </figure>
                        </div> 
                    {% endfor %}
                  
                </div> 
        
        
                <nav class="mt-4" aria-label="Page navigation sample">
                    <ul class="pagination">
                        <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item"><a class="page-link" href="#">Next</a></li>
                    </ul>
                </nav>

                <button class="loadMore">نتیج بیشتر</button>
        
            </main> 
        
        </div>
    
    </div> 
</section>

{% else %}

<section class="section-pagetop bg" style="height:100%!important">
    <div class="container text-center">
        <h2 class="title-page"> آگهی یافت نشد</h2>
    </div> 
</section>

{% endif %}





<script type="text/javascript" >
    $(document).ready(function(){
        $(".loadMore").click(function(){

            var current_result=$("getComs").length;
            $.ajax({
                url:"{% url 'loadMore' %}",
                type:"post",
                data:{
                    "offset":current_result,
                    'csrfmiddlewaretoken':"{{csrf_token}}",

                },
                dataType:"json",
                beforeSend:function(){
                    $('.loadMore').addClass("disabled").text("در حال پردازش")
                },
                success:function(e){
                    //console.log(e)   
                    $('.loadMore').removeClass("disabled").text("نتایج بیشتر")
                    
                    let parsed=JSON.parse(e.data)
                    console.log(parsed)
                    
                    $.each(parsed,function(index,el){
                        let newDiv=`
                        <div class="col-md-4 getComs">
                            <figure class="card card-product-grid" >
                                <div class="img-wrap"> 
                                    {% if c.commericalimage_set.all %}
                                            <img src="{{c.commericalimage_set.first.image.url}}">
                                    {% endif %}
                                    
                                </div> <!-- img-wrap.// -->
                                <figcaption class="info-wrap" >
                                    <div class="fix-height" style="height:100px">
                                        <a href="./product-detail.html" class="title">
                                            {{c.title|slice:"20"}}
                                        </a>
                                        <div class="price-wrap mt-2">

                                            {% if c.parent.parent.parent %}

                                                        {% if c.parent.parent.parent.title == "املاک" %}

                                                                {% if  c.parent.parent.title == "فروش مسکونی" %}
                                                                    <span class="price">{{c.price|intcomma}}</span>    تومان
                                                                    <br>
                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span>    

                                                                {% elif  c.parent.parent.title == "اجاره مسکونی" %}

                                                                    ودیعه <span class="price">{{c.vadieh|intcomma}}</span>    تومان
                                                                        <br>
                                                                        اجاره <span class="price">{{c.rent|intcomma}}</span>    تومان
                                                                        <br>
                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>
                                                                        <br>

                                                                {% endif %}

                                                                <!-- وسایل نقلیه -->

                                                        {% elif c.parent.parent.parent.title == "وسایل نقلیه" %}

                                                                {% if c.parent.parent %}

                                                                    <!-- خودرو -->

                                                                    {% if c.parent.parent.title == "خودرو" %}

                                                                        {% if c.parent.title == "سواری و وانت" %}
                                                                                <span class="price">{{c.karkard_mashin|intcomma}}</span> کیلومتر
                                                                                <br>
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span>

                                                                        {% elif c.parent.title == "کلاسیک" %}
                                                                                <span class="price">{{c.karkard_mashin|intcomma}}</span> کیلومتر
                                                                                <br>
                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span>
                                                                        {% elif c.parent.title == "اجاره" %}
                                                                                <span class="price">{{c.day_rent_paid|intcomma}}</span> تومان
                                                                                <br>
                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span>   
                                                                        {% elif c.parent.title == "سنگین" %}
                                                                                <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                <br>
                                                                                <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                <span class="price">{{c.iranTimeCreated|findTime}}</span> 

                                                                        {% endif %}

                                                                    {% endif %}
                                                                
                                                                {% endif %}
                                                        
                                                        {% elif c.parent.parent.parent.title == "کالای دیجیتال" %}
                                                                
                                                                {% if c.parent.parent %}
                                                                        {% if c.parent.parent.title == "موبایل و تبلت" %}
                                                                                {% if c.parent.title == "گوشی موبایل" %}
                                                                                    <span class="price">{{c.phone_status}}</span> 
                                                                                    <br>
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                {% elif c.parent.title == "تبلت" %}

                                                                                    <span class="price">{{c.phone_status}}</span> 
                                                                                    <br>
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                {% elif c.parent.title == "لوازم جانبی موبایل و تبلت" %}

                                                                            
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span> 

                                                                                {% elif c.parent.title == "سیم کارت" %}

                                                                                
                                                                                {% endif %}
                                                                        {% elif c.parent.parent.title == "رایانه" %}
                                                                                {% if c.parent.title == "رایانه همراه" %}
                                                                                    <span class="price">{{c.phone_status}}</span> 
                                                                                    <br>
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                {% elif c.parent.title == "رایانه رومیزی" %}

                                                                                    <span class="price">{{c.phone_status}}</span> 
                                                                                    <br>
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                {% elif c.parent.title == "قطعات و لوازم جانبی" %}
                                                                                    <span class="price">{{c.phone_status}}</span> 
                                                                                    <br>
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                {% elif c.parent.title == "مودم و شبکه" %}
                                                                                    <span class="price">{{c.phone_status}}</span> 
                                                                                    <br>
                                                                                    <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                    <br>
                                                                                    <!-- <span class="price">{{c.price|intcomma}}</span> تومان -->
                                                                                    <span class="price">{{c.iranTimeCreated|findTime}}</span>
                                                                                
                                                                                {% endif %}

                                                                        {% endif %}
                                                                {% endif %}

                                                        {% endif %}


                                            {% elif not c.parent.parent.parent %}
                                                    {% if c.parent.parent %}
                                                                    {% if c.parent.parent.title == "وسایل نقلیه" %}
                                                                                {% if c.parent.title == "موتور سیکلت" %}

                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span> 
                                                                                
                                                                                {% elif c.parent.title == "قطعات یدکی" %}

                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>

                                                                                {% elif c.parent.title == "قایق و سایر" %}
                                                                                        <span class="price">{{c.price|intcomma}}</span> تومان
                                                                                        <br>
                                                                                        <span class="price">{{c.iranTimeCreated|findTime}}</span>
                                                                                {% endif %}
                                                                        

                                                                    {% endif %}
                                                    {% endif %}
                                                                            
                                            {% endif %}
                                            
                                        </div> 
                                    </div>
                                    <br>
                                    <br>
                                    <br>
                                    <a href="#" class="btn btn-block btn-success">Added to cart </a>
                                </figcaption>
                            </figure>
                        </div>
                        `
                    })
                   
                    
                }
            })

        })

    })
</script>








{% endblock content %}




























{% comment %}
<script type="text/javascript">
  
	var qs = '{{all_city}}'
	console.log(qs,typeof qs,)
	var data=JSON.parse(qs.replace(/&quot;/g,'"'))
	const input=document.getElementById("cityInput")
	console.log(data)
  
  
	
  
  
  
	let filtred=[]
	input.addEventListener("keyup",(e)=>{
  
	  
		var ggg=$(".rrrrrrrrr")
		ggg.html("<p></p>")
	
   
	  filtred=data.filter(item=>item["name"].includes(e.target.value))
  
  
  
  
	  if(filtred.length>0){
  
		  
  
  
			filtred.forEach(item=>{
  
			  var subs=item.minis.map(ee=>{
  
						   
								  
								return `
										<div class="panel panel-default">
										  <div class="panel-heading">
											<h4 class="panel-title">
											  <a data-toggle="collapse" href="#scan1_api${ee.id}" data-parent="#scan1_inner_accordion">${ee.name}</a>
                        <input type="checkbox" name="items" id="" value="${ee.id}">
											</h4>
										  </div>
										  
										</div>
		
										`       
			  })
  
			  ggg.append(`
  
				  <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
              <a data-toggle="collapse" href="#collapse${item['cityId']}" data-parent="#accordion">${item["name"]}</a>
              </h4>
            </div>
            <div id="collapse${item['cityId']}" class="panel-collapse collapse">
              <ul class="list-group">
              <li class="list-group-item">
                <div class="panel-group" id="scan1_inner_accordion">
                  <label for="">انتخاب همه</label>
                  <input type="checkbox" name="bigCity" id="" value="${item["cityId"]}" >

                  
                  ${subs}
                  
          
                </div>
              </li>
              </ul>
              
            </div>
				  </div>
			`)
  
		  })
			}
  
	})
  


    let v7=$(".eachCat-")
    console.log(v7,"EEEEEAAACCHHH")
    console.log(v7,"EEEEEAAACCHHH")
    console.log(v7,"EEEEEAAACCHHH")


    $("#ParentCats").click(function(){

        let eachCatId=$(this).attr("class").substring(8)


        const url =`http://127.0.0.1:8000/eachCategory/${eachCatId}/`

        console.log("FFFFFFUUUUNNNNN")

        const g=$(".city_choosen")

        var dd=$(".city_choosen")
        var vv=dd.children("p")
    
        let mini_cities=[]
        let province=[]
    
        vv.each(function(index,el){
    
        console.log($(el).attr("class"))
        if($(el).attr("class").includes("mini")){
            mini_cities.push($(el).attr("class").substring(8))
            
        }else{
            province.push($(el).attr("class").substring(3))
        }
    
        })

        var mini_cities_ids=mini_cities.map(item=>Number(item))
        var provinces_ids=province.map(item=>Number(item))

        console.log("HELOOOOOOOOOOOOOOO")
        console.log("HELOOOOOOOOOOOOOOO")
        
        console.log(mini_cities_ids)
        console.log(provinces_ids)
        console.log("HELOOOOOOOOOOOOOOO")
        console.log("HELOOOOOOOOOOOOOOO")

        let form=new FormData()
        form.append('csrfmiddlewaretoken', $('input[name=csrfmiddlewaretoken]').val()) 
        form.append("bigCity",provinces_ids)
        form.append("items",mini_cities_ids)
        console.log(form,"FFFOOROROOROROMMM")
    
     


    })
  
</script>

<span class="price">


    {% with now=now_to_irani.minute  com_time=c.iranTimeCreated.minute %}

        
    


        {% if  now|sub:com_time < 5 %}
            لحظاتی پیش
        {% endif %}
        
    {% endwith %}


    {{c.iranTimeCreated.year}}
</span>    
{% endcomment %}